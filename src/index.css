@import "tailwindcss";

/* Wolfe Word Book Theme Colors and Fonts */
@theme {
  --color-primary: #0080BB;
  --color-secondary: #87D9FF;
  --color-secondary-2: #CEEAF9;
  --color-tertiary: #F3FBFF;
  --color-grey: #D9D9D9;
  --color-grey-darker: #9B9B9B;
  --color-black: #000000;
  --color-white: #FFFFFF;
  --color-orange: #FF5900;
  --color-orange-yellow: #FFC800;
  --color-green: #95FF87;
  --color-pink: #FF7787;
  
  /* Feedback colors for correct/wrong answers */
  --color-light-green: rgba(34, 197, 94, 0.4);
  --color-dark-green: rgba(34, 197, 94, 0.9);
  --color-light-pink: rgba(236, 72, 153, 0.4);
  --color-dark-pink: rgba(236, 72, 153, 0.9);
  
  /* Font family for bilingual text */
  --font-family: Inter, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", sans-serif;
  
  /* Typography tokens for consistent hierarchy */
  --txt-display: text-xl lg:text-2xl font-semibold;
  --txt-body-lg: text-lg font-medium;
  --txt-body: text-base font-normal;
  --txt-caption: text-sm font-medium;
  --txt-label: text-sm font-semibold;
  /* A consistent, theme-aligned shadow color. Using a semi-transparent version of the primary color ensures cross-browser consistency. */
  --color-shadow: rgba(0, 128, 187, 0.3);
  /* The shadow input was for inputs in wordcard initially, but now it seems that we don't need it anymore. */
  --shadow-input: inset 1px 3px 4px 0 rgba(0, 0, 0, 0.25);
  --shadow-play-button: 0px 1px 2px rgba(0, 0, 0, 0.25);
  --shadow-timer: 0 0px 4px 3px rgba(0, 0, 0, 0.05);
  --content-width: 90%;
  --content-width-2: 90%;

  /* Pulse keyframes */
  @keyframes pulse {
    0%   { transform: translate(-50%, -50%) scale(1);   opacity: 1;   }
    50%  { transform: translate(-50%, -50%) scale(1.4); opacity: 0.7; }
    100% { transform: translate(-50%, -50%) scale(1);   opacity: 0;   }
  }
}

/* Global font family */
body {
  font-family: var(--font-family);
}

/* Hide scrollbars for all browsers */
* {
  -ms-overflow-style: none; /* IE and Edge */
  scrollbar-width: none; /* Firefox */
}

*::-webkit-scrollbar {
  display: none; /* Chrome, Safari, Opera */
}

/* iOS smooth scrolling utility */
.touch-scroll {
  -webkit-overflow-scrolling: touch;
}

/*Define and animate a custom angle property (--border-angle) for spinning conic gradient effects. Used in .btn-animated-wrapper to create a rotating border animation.*/
@property --border-angle {
  syntax: '<angle>';
  inherits: false;
  initial-value: 0deg;
}

@keyframes border-spin {
  from {
    --border-angle: 0deg;
  }
  to {
    --border-angle: 360deg;
  }
}

@layer components {
  .btn-disabled {
    /* Updated padding to px-6 py-2.5 for larger button size - matches .btn-animated for consistency */
    @apply w-full px-6 py-2.5 rounded-full text-lg font-medium transition-colors shadow-md bg-gray-400 text-white cursor-not-allowed;
  }
  .btn-animated-wrapper {
    /* Gradient border wrapper with thinner border (p-1) and fixed min-height to prevent layout shift */
    @apply rounded-full p-1 mx-auto shadow-md min-h-[3.5rem] flex items-center [animation:border-spin_1.3s_linear_infinite];
    background: conic-gradient(from var(--border-angle), #ec4899 0%, #3b82f6 25%, #facc15 50%, #22c55e 75%, #ec4899 100%);
    transition: opacity 0.3s ease-in-out;
  }
  .btn-animated {
    /* Enlarged button with larger padding and text size to match .btn-disabled */
    @apply w-full px-6 py-2.5 rounded-full text-lg font-medium transition-colors bg-[var(--color-secondary)] text-white hover:bg-[var(--color-secondary-2)];
  }

  /* Submit button specific styles matching play button dimensions */
  .btn-submit-wrapper {
    /* Gradient border wrapper matching play button size */
    @apply rounded-full p-1 mx-auto shadow-md flex items-center [animation:border-spin_1.3s_linear_infinite];
    background: conic-gradient(from var(--border-angle), #ec4899 0%, #3b82f6 25%, #facc15 50%, #22c55e 75%, #ec4899 100%);
    transition: opacity 0.3s ease-in-out;
    width: 7.5rem;
    height: 3rem;
  }

  .btn-submit {
    /* Inner submit button filling the wrapper */
    @apply w-full h-full rounded-full text-lg font-medium transition-colors bg-[var(--color-secondary)] text-white;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .btn-submit-disabled-wrapper {
    /* Post-submission wrapper - same size, no gradient animation */
    @apply rounded-full mx-auto shadow-md flex items-center;
    background: var(--color-grey);
    width: 7.5rem;
    height: 3rem;
  }

  .btn-submit-disabled {
    /* Inner disabled submit button */
    @apply w-full h-full rounded-full text-lg font-medium cursor-not-allowed bg-gray-400 text-white;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  /* Glassmorphism Effect for play button and selected options */
  .glass-effect {
    /* Flex properties to center content */
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    /* Height is 1/3 of parent's height, assuming parent has defined height */
    height: calc(100% / 3);
    cursor: pointer;
    
    /* Glassmorphism styling using tertiary color with transparency */
    background: var(--color-secondary);
    
    /* Subtle border to catch light and define edges */
    border-left: 2px solid rgba(255, 255, 255, 0.5);
    border-top: 2px solid rgba(255, 255, 255, 0.5);
    border-right: 2px solid #0080bb20;
    border-bottom: 2px solid #0080bb20;
    
    /* Smooth transition for interactions */
    transition: transform 1s ease-in-out;
  }

  .glass-effect:active {
    /* Slight transform on click */
    transform: scale(1.05);
  }

  /* Play button specific styles */
  .glass-play-button {
    margin: 0 auto;
    width: 7.5rem;
    height: 3rem;
  }

  /* Content container for glass effect */
  .glass-content {
    position: relative;
    z-index: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    height: 100%;
  }

  /* Play button SVG styles */
  .glass-play-svg {
    width: 80%;
    height: 80%;
    fill: var(--color-white);
    transition: transform 1s ease;
  }
  
  .glass-effect:active .glass-play-svg {
    transform: scale(1.1);
  }

  /* Glowing text animation for the Chinese prompt */
  .animated-glow-wrapper {
    position: relative;
    overflow: hidden;
    display: inline-block; /* Ensures the pseudo-element is contained within the text width */
  }

  .animated-glow-wrapper::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%; /* Start off-screen to the left */
    width: 100%;
    height: 100%;
    /* Create the glowing line effect using a linear gradient */
    background: linear-gradient(to right, transparent, var(--color-tertiary), transparent);
    /* Apply the animation: glow-line (defined below), 4 seconds duration, linear timing, infinite loop */
    animation: glow-line 4s linear infinite;
  }

  /* Keyframes for the glowing line animation */
  @keyframes glow-line {
    0% {
      left: -100%; /* Start completely off-screen to the left */
    }
    100% {
      left: 100%; /* Move completely off-screen to the right */
    }
  }

  .word-card-style {
    border-radius: 30px;
    background: var(--color-tertiary);
    box-shadow: 8px 8px 16px var(--color-shadow);
    border: 3px solid var(--color-white);
    transition: transform 0.3s ease, opacity 0.3s ease, max-height 0.4s ease-out;
    max-height: 30vh; /* Default height */
  }

  .word-card-expanded {
    max-height: 75vh; /* Expanded height */
  }

  /* Smooth growing animations for card sections */
  .card-section-enter {
    animation: slideInUp 0.4s ease-out forwards;
  }

  @keyframes slideInUp {
    from {
      opacity: 0;
      transform: translateY(20px) scale(0.95);
      max-height: 0;
    }
    to {
      opacity: 1;
      transform: translateY(0) scale(1);
      max-height: 200px; /* Large enough to accommodate content */
    }
  }

  

  /* Submit button grow animation */
  .submit-button-enter {
    animation: bounceIn 0.3s ease-out forwards;
  }

  /* Staggered entrance animations for option buttons */
  .option-stagger-enter {
    animation: slideInUp 0.4s ease-out forwards;
    /* Start invisible - will animate in */
    opacity: 0;
    transform: translateY(20px) scale(0.95);
  }

  .option-stagger-0 {
    animation-delay: 0s;      /* First option - immediate */
  }
  
  .option-stagger-1 {
    animation-delay: 0.1s;    /* Second option - 100ms delay */
  }
  
  .option-stagger-2 {
    animation-delay: 0.2s;    /* Third option - 200ms delay */
  }
  
  .option-stagger-3 {
    animation-delay: 0.3s;    /* Fourth option - 300ms delay */
  }


  @keyframes bounceIn {
    from {
      opacity: 0;
      transform: translateY(20px) scale(0.8);
    }
    60% {
      opacity: 1;
      transform: translateY(-5px) scale(1.05);
    }
    to {
      opacity: 1;
      transform: translateY(0) scale(1);
    }
  }

  @keyframes fadeOutScale {
    from {
      opacity: 1;
      transform: scale(1);
    }
    to {
      opacity: 0;
      transform: scale(0.8);
    }
  }

  .submit-button-exit {
    animation: fadeOutScale 0.25s ease-out forwards;
  }

  /* CSS-only active card detection using scroll-driven animations */
  @supports (animation-timeline: scroll()) {
    .word-card-container {
      animation: detect-active linear;
      animation-timeline: scroll(inline nearest);
      animation-range: contain;
    }
    
    @keyframes detect-active {
      0%, 100% { 
        opacity: 0.7;
        transform: scale(0.95);
      }
      40%, 60% { 
        opacity: 1;
        transform: scale(1);
      }
    }
  }

  /* Fallback for browsers without scroll-driven animations */
  @supports not (animation-timeline: scroll()) {
    .word-card-container {
      position: relative;
    }
    
    .word-card-container .word-card-style {
      opacity: 0.7;
      transform: scale(0.95);
    }
    
    /* Use IntersectionObserver-like behavior with scroll-snap */
    @media (hover: none) and (pointer: coarse) {
      .snap-center .word-card-style {
        animation: fade-in 0.3s ease forwards;
      }
      
      @keyframes fade-in {
        to {
          opacity: 1;
          transform: scale(1);
        }
      }
    }
  }

  /* Timer wrapper with darker shadow for better visibility */
  .timer-shadow-style {
    border-radius: 30px;
    background: var(--color-tertiary);
    /* Darker shadow using color-grey for better visibility against page background */
    box-shadow: 5px 5px 15px var(--color-shadow);
    border: 3px solid var(--color-white);
  }

  /* Nav bar styling matching word card design */
  .nav-bar-style {
    border-radius: 30px;
    background: var(--color-tertiary);
    box-shadow: 8px 8px 16px var(--color-shadow);
    border: 3px solid var(--color-white);
  }

  /* Timer wrapper styling matching word card design */
  .timer-wrapper-style {
    border-radius: 30px;
    background: var(--color-tertiary);
    box-shadow: 15px 15px 30px var(--color-shadow);
    border: 3px solid var(--color-white);
  }

  /* Main container style for the app layout */
  .main-container-style {
    /* Applies an inner shadow to the top of the container, matching the word card's shadow style */
    box-shadow: inset 0px 15px 30px var(--color-shadow);
  }

  /* Option button styles for Chinese meaning selection */
  .option-button {
    @apply flex items-center gap-2 p-1 rounded-xl font-medium text-left w-full;
    background: var(--color-white);
    /* Use consistent border structure for smooth transitions */
    border: 2px solid var(--color-grey);
    color: var(--color-grey);
    /* Force hardware acceleration and smooth transitions */
    transform: translateZ(0);
    transition: all 0.2s ease-out, border-left 0.2s ease-out, border-top 0.2s ease-out, border-right 0.2s ease-out, border-bottom 0.2s ease-out;
  }


  .option-default {
    /* Default state already handled in .option-button */
  }

  .option-selected {
    background: var(--color-secondary) !important;
    border-left: 2px solid rgba(255, 255, 255, 0.5) !important;
    border-top: 2px solid rgba(255, 255, 255, 0.5) !important;
    border-right: 2px solid #0080bb20 !important;
    border-bottom: 2px solid #0080bb20 !important;
    color: var(--color-white) !important;
    box-shadow: 0 0 15px rgba(135, 217, 255, 0.4);
    /* Force repaint on iOS Safari */
    will-change: border-color, background-color;
  }
  .option-disabled {
    @apply cursor-not-allowed opacity-60;
  }

  .option-label {
    @apply font-bold text-sm;
    min-width: 20px;
  }

  .option-text {
    @apply flex-1;
    overflow: hidden;
    white-space: nowrap;
  }

  .marquee-container {
    display: inline-block;
    animation: marquee-scroll 5s linear infinite;
    white-space: nowrap; /* Ensure content stays on one line */
  }

  .marquee-content {
    display: inline-block;
    padding-right: 2rem; /* Gap between original and duplicate text */
  }

  .static-text {
    display: inline-block;
  }

  @keyframes marquee-scroll {
    0% {
      transform: translateX(0);
    }
    100% {
      transform: translateX(-50%); /* Scroll to the start of the duplicated content */
    }
  }

  /* Answer Feedback Animation Keyframes */
  @keyframes pulse-green-glow {
    0% {
      box-shadow: 0 0 5px rgba(34, 197, 94, 0.4);
      border-color: rgba(34, 197, 94, 0.3);
    }
    50% {
      box-shadow: 0 0 4px rgba(34, 197, 94, 0.8), 0 0 4px rgba(34, 197, 94, 0.6);
      border-color: rgba(34, 197, 94, 0.7);
    }
    100% {
      box-shadow: 0 0 5px rgba(34, 197, 94, 0.4);
      border-color: rgba(34, 197, 94, 0.3);
    }
  }

  @keyframes pulse-pink-glow {
    0% {
      box-shadow: 0 0 5px rgba(236, 72, 153, 0.4);
      border-color: rgba(236, 72, 153, 0.3);
    }
    50% {
      box-shadow: 0 0 4px rgba(236, 72, 153, 0.8), 0 0 4px rgba(236, 72, 153, 0.6);
      border-color: rgba(236, 72, 153, 0.7);
    }
    100% {
      box-shadow: 0 0 5px rgba(236, 72, 153, 0.4);
      border-color: rgba(236, 72, 153, 0.3);
    }
  }

  /* Answer Feedback Classes */
  .option-correct-pulse {
    animation: pulse-green-glow 2s ease-in-out;
    /* Override existing styles during animation */
    background: var(--color-white) !important;
    color: rgba(34, 197, 94, 0.8) !important;
    border: 2px solid rgba(34, 197, 94, 0.5) !important;
  }

  .option-wrong-pulse {
    animation: pulse-pink-glow 2s ease-in-out;
    /* Override existing styles during animation */
    background: var(--color-white) !important;
    color: rgba(236, 72, 153, 0.8) !important;
    border: 2px solid rgba(236, 72, 153, 0.5) !important;
  }

  .option-correct-shadow {
    border: 2px solid var(--color-light-green) !important;
    color: var(--color-dark-green) !important;
  }

  .option-wrong-shadow {
    border: 2px solid var(--color-light-pink) !important;
    color: var(--color-dark-pink) !important;
  }

  /* Input Feedback Animation System */
  
  /* Input container for letter animations */
  .input-container {
    position: relative;
    overflow: hidden;
    width: 100%;
    height: 100%;
  }

  /* Input glow animations matching option feedback */
  .input-correct-pulse {
    animation: pulse-green-glow .5s ease-in-out;
    border-color: rgba(34, 197, 94, 0.5) !important;
    background-color: var(--color-white) !important;
    box-shadow: 0 0 15px rgba(34, 197, 94, 0.4) !important;
  }

  .input-wrong-pulse {
    animation: pulse-pink-glow .5s ease-in-out;
    border-color: rgba(236, 72, 153, 0.5) !important;
    background-color: var(--color-white) !important;
    box-shadow: 0 0 15px rgba(236, 72, 153, 0.4) !important;
  }

  /* Permanent input styling after animations */
  .input-correct-shadow {
    border-color: var(--color-light-green) !important;
    background-color: var(--color-white) !important;
    color: var(--color-dark-green) !important;
  }

  .input-wrong-shadow {
    border-color: var(--color-light-pink) !important;
    background-color: var(--color-white) !important;
    color: var(--color-dark-pink) !important;
  }


  /* Card flip animation keyframes */
  @keyframes card-flip-double {
    0% {
      transform: rotateX(0deg);
    }
    25% {
      transform: rotateX(-90deg);
    }
    50% {
      transform: rotateX(0deg);
    }
    75% {
      transform: rotateX(-90deg);
    }
    100% {
      transform: rotateX(0deg);
    }
  }

  /* Reusable card flip animation class */
  .card-flip-animation {
    animation: card-flip-double 0.8s ease-in-out;
    transform-style: preserve-3d;
  }
}
